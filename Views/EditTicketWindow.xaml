<Window x:Class="TA_WPF.Views.EditTicketWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:TA_WPF.Views"
        xmlns:utils="clr-namespace:TA_WPF.Utils"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes" 
        xmlns:viewmodels="clr-namespace:TA_WPF.ViewModels" 
        xmlns:converters="clr-namespace:TA_WPF.Converters" 
        d:DataContext="{d:DesignInstance Type=viewmodels:EditTicketViewModel}"
        mc:Ignorable="d"
        d:DesignHeight="1200" d:DesignWidth="900"
        Title="修改车票" Height="1050" Width="900"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResizeWithGrip"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        TextElement.FontWeight="Regular"
        TextElement.FontSize="{DynamicResource MaterialDesignFontSize}"
        TextOptions.TextFormattingMode="Ideal"
        TextOptions.TextRenderingMode="Auto"
        Background="{DynamicResource MaterialDesignPaper}"
        FontFamily="Microsoft YaHei"
        SizeToContent="Manual">

    <Window.Resources>
        <ResourceDictionary>
            <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
            <converters:StationNameConverter x:Key="StationNameConverter" />

            <!-- 表单标签样式 -->
            <Style x:Key="FormLabelStyle" TargetType="TextBlock">
                <Setter Property="Margin" Value="0,0,8,0"/>
                <Setter Property="VerticalAlignment" Value="Center"/>
                <Setter Property="FontWeight" Value="Medium"/>
                <Setter Property="FontFamily" Value="Microsoft YaHei"/>
                <Setter Property="FontSize" Value="{DynamicResource MaterialDesignFontSize}"/>
            </Style>

            <!-- 文本框样式 -->
            <Style x:Key="FormTextBoxStyle" TargetType="TextBox" BasedOn="{StaticResource MaterialDesignCustomTextBox}">
                <Setter Property="Margin" Value="0,8,0,8"/>
                <Setter Property="FontFamily" Value="Microsoft YaHei"/>
                <Setter Property="Height" Value="Auto"/>
                <Setter Property="MinHeight" Value="45"/>
                <Setter Property="Foreground" Value="{DynamicResource MaterialDesignBody}"/>
            </Style>

            <!-- 数字文本框样式 -->
            <Style x:Key="FormNumberTextBoxStyle" TargetType="TextBox" BasedOn="{StaticResource MaterialDesignCustomNumberTextBox}">
                <Setter Property="Margin" Value="0,8,0,8"/>
                <Setter Property="FontFamily" Value="Microsoft YaHei"/>
                <Setter Property="Height" Value="Auto"/>
                <Setter Property="MinHeight" Value="45"/>
                <Setter Property="Foreground" Value="{DynamicResource MaterialDesignBody}"/>
            </Style>

            <!-- 搜索文本框样式 -->
            <Style x:Key="FormSearchTextBoxStyle" TargetType="TextBox" BasedOn="{StaticResource MaterialDesignCustomTextBox}">
                <Setter Property="Margin" Value="0,8,0,8"/>
                <Setter Property="FontFamily" Value="Microsoft YaHei"/>
                <Setter Property="Height" Value="Auto"/>
                <Setter Property="MinHeight" Value="45"/>
                <Setter Property="Foreground" Value="{DynamicResource MaterialDesignBody}"/>
            </Style>

            <!-- 下拉框样式 -->
            <Style x:Key="FormComboBoxStyle" TargetType="ComboBox" BasedOn="{StaticResource MaterialDesignComboBox}">
                <Setter Property="Margin" Value="0,8,0,8"/>
                <Setter Property="FontFamily" Value="Microsoft YaHei"/>
                <Setter Property="Height" Value="Auto"/>
                <Setter Property="MinHeight" Value="45"/>
                <Setter Property="Foreground" Value="{DynamicResource MaterialDesignBody}"/>
            </Style>

            <!-- 下拉框选项样式 -->
            <Style x:Key="FormComboBoxItemStyle" TargetType="ComboBoxItem" BasedOn="{StaticResource MaterialDesignComboBoxItemStyle}">
                <Setter Property="HorizontalContentAlignment" Value="Center"/>
                <Setter Property="VerticalContentAlignment" Value="Center"/>
                <Setter Property="Height" Value="Auto"/>
                <Setter Property="MinHeight" Value="35"/>
                <Setter Property="Padding" Value="16,8"/>
                <Setter Property="Foreground" Value="{DynamicResource MaterialDesignBody}"/>
            </Style>

            <!-- 滚动条样式 -->
            <Style x:Key="AutoHideScrollViewerStyle" TargetType="ScrollViewer">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="ScrollViewer">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <ScrollContentPresenter Grid.Column="0" Grid.Row="0"/>
                                <ScrollBar x:Name="PART_VerticalScrollBar"
                                         Grid.Column="1" Grid.Row="0"
                                         Value="{TemplateBinding VerticalOffset}"
                                         Maximum="{TemplateBinding ScrollableHeight}"
                                         ViewportSize="{TemplateBinding ViewportHeight}"
                                         Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}"/>
                                <ScrollBar x:Name="PART_HorizontalScrollBar"
                                         Grid.Column="0" Grid.Row="1"
                                         Orientation="Horizontal"
                                         Value="{TemplateBinding HorizontalOffset}"
                                         Maximum="{TemplateBinding ScrollableWidth}"
                                         ViewportSize="{TemplateBinding ViewportWidth}"
                                         Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}"/>
                            </Grid>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </ResourceDictionary>
    </Window.Resources>

    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 标题 -->
        <TextBlock Grid.Row="0" 
                   Text="修改车票" 
                   Style="{StaticResource MaterialDesignHeadline5TextBlock}" 
                   Margin="0,0,0,16"/>

        <!-- 表单内容 -->
        <ScrollViewer Grid.Row="1" 
                      VerticalScrollBarVisibility="Auto" 
                      HorizontalScrollBarVisibility="Disabled"
                      Style="{StaticResource AutoHideScrollViewerStyle}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- 第一行：取票号、检票位置 -->
                <TextBlock Grid.Row="0" Grid.Column="0" 
                           Text="取票号:" 
                           Style="{StaticResource FormLabelStyle}"/>
                <TextBox Grid.Row="0" Grid.Column="1" 
                         Text="{Binding TicketNumber, UpdateSourceTrigger=PropertyChanged}" 
                         Style="{StaticResource FormTextBoxStyle}"
                         materialDesign:HintAssist.Hint="取票号"
                         Tag="TicketNumber"
                         Margin="0,8,16,8"/>

                <TextBlock Grid.Row="0" Grid.Column="2" 
                           Text="检票口:" 
                           Style="{StaticResource FormLabelStyle}"/>
                <TextBox Grid.Row="0" Grid.Column="3" 
                         Text="{Binding CheckInLocation, UpdateSourceTrigger=PropertyChanged}" 
                         Style="{StaticResource FormTextBoxStyle}"
                         materialDesign:HintAssist.Hint="检票口"
                         Margin="0,8,0,8"/>

                <!-- 第二行：出发站、到达站 -->
                <TextBlock Grid.Row="1" Grid.Column="0" 
                           Text="出发站:" 
                           Style="{StaticResource FormLabelStyle}"/>
                <Grid Grid.Row="1" Grid.Column="1" Margin="0,8,16,8">
                    <TextBox 
                         Text="{Binding DepartStationSearchText, UpdateSourceTrigger=PropertyChanged}"
                         Style="{StaticResource FormSearchTextBoxStyle}"
                         materialDesign:HintAssist.Hint="出发站"
                         Tag="Depart"
                         InputMethod.IsInputMethodEnabled="True"
                         InputMethod.PreferredImeState="On"
                         InputMethod.PreferredImeConversionMode="Native"
                         LostFocus="DepartStation_LostFocus"
                         Margin="0"/>
                    <TextBlock Text="站" 
                              HorizontalAlignment="Right" 
                              VerticalAlignment="Center" 
                              Margin="0,0,8,0"/>
                    <Popup IsOpen="{Binding IsDepartStationDropdownOpen}" 
                           PlacementTarget="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Grid}}"
                           Width="{Binding ActualWidth, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Grid}}"
                           StaysOpen="False">
                        <Border Background="{DynamicResource MaterialDesignPaper}" 
                                BorderBrush="{DynamicResource MaterialDesignDivider}" 
                                BorderThickness="1" 
                                MaxHeight="200">
                            <ScrollViewer VerticalScrollBarVisibility="Auto"
                                        Style="{StaticResource AutoHideScrollViewerStyle}">
                                <ItemsControl ItemsSource="{Binding DepartStationSuggestions}"
                                            KeyboardNavigation.DirectionalNavigation="Cycle"
                                            KeyboardNavigation.TabNavigation="Cycle">
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel KeyboardNavigation.DirectionalNavigation="Cycle"/>
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Button Command="{Binding DataContext.SelectDepartStationCommand, 
                                                     RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                                                    CommandParameter="{Binding}"
                                                    Content="{Binding StationName, Converter={StaticResource StationNameConverter}}"
                                                    HorizontalContentAlignment="Center"
                                                    Style="{StaticResource MaterialDesignFlatButton}"
                                                    Width="{Binding ActualWidth, 
                                                            RelativeSource={RelativeSource Mode=FindAncestor, 
                                                            AncestorType=ScrollViewer}}"
                                                    FocusVisualStyle="{DynamicResource MaterialDesignFocusVisual}"/>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </ScrollViewer>
                        </Border>
                    </Popup>
                </Grid>

                <TextBlock Grid.Row="1" Grid.Column="2" 
                           Text="到达站:" 
                           Style="{StaticResource FormLabelStyle}"/>
                <Grid Grid.Row="1" Grid.Column="3" Margin="0,8,0,8">
                    <TextBox 
                         Text="{Binding ArriveStationSearchText, UpdateSourceTrigger=PropertyChanged}"
                         Style="{StaticResource FormSearchTextBoxStyle}"
                         materialDesign:HintAssist.Hint="到达站"
                         Tag="Arrive"
                         InputMethod.IsInputMethodEnabled="True"
                         InputMethod.PreferredImeState="On"
                         InputMethod.PreferredImeConversionMode="Native"
                         LostFocus="ArriveStation_LostFocus"
                         Margin="0"/>
                    <TextBlock Text="站" 
                              HorizontalAlignment="Right" 
                              VerticalAlignment="Center" 
                              Margin="0,0,8,0"/>
                    <Popup IsOpen="{Binding IsArriveStationDropdownOpen}" 
                           PlacementTarget="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Grid}}"
                           Width="{Binding ActualWidth, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Grid}}"
                           StaysOpen="False">
                        <Border Background="{DynamicResource MaterialDesignPaper}" 
                                BorderBrush="{DynamicResource MaterialDesignDivider}" 
                                BorderThickness="1" 
                                MaxHeight="200">
                            <ScrollViewer VerticalScrollBarVisibility="Auto"
                                        Style="{StaticResource AutoHideScrollViewerStyle}">
                                <ItemsControl ItemsSource="{Binding ArriveStationSuggestions}"
                                            KeyboardNavigation.DirectionalNavigation="Cycle"
                                            KeyboardNavigation.TabNavigation="Cycle">
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel KeyboardNavigation.DirectionalNavigation="Cycle"/>
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Button Command="{Binding DataContext.SelectArriveStationCommand, 
                                                     RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                                                    CommandParameter="{Binding}"
                                                    Content="{Binding StationName, Converter={StaticResource StationNameConverter}}"
                                                    HorizontalContentAlignment="Center"
                                                    Style="{StaticResource MaterialDesignFlatButton}"
                                                    Width="{Binding ActualWidth, 
                                                            RelativeSource={RelativeSource Mode=FindAncestor, 
                                                            AncestorType=ScrollViewer}}"
                                                    FocusVisualStyle="{DynamicResource MaterialDesignFocusVisual}"/>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </ScrollViewer>
                        </Border>
                    </Popup>
                </Grid>

                <!-- 第三行：出发站拼音、到达站拼音 -->
                <TextBlock Grid.Row="2" Grid.Column="0" 
                           Text="出发站拼音:" 
                           Style="{StaticResource FormLabelStyle}"/>
                <TextBox Grid.Row="2" Grid.Column="1" 
                         Text="{Binding DepartStationPinyin, UpdateSourceTrigger=PropertyChanged}" 
                         Style="{StaticResource FormTextBoxStyle}"
                         materialDesign:HintAssist.Hint="出发站拼音"
                         Margin="0,8,16,8"/>

                <TextBlock Grid.Row="2" Grid.Column="2" 
                           Text="到达站拼音:" 
                           Style="{StaticResource FormLabelStyle}"/>
                <TextBox Grid.Row="2" Grid.Column="3" 
                         Text="{Binding ArriveStationPinyin, UpdateSourceTrigger=PropertyChanged}" 
                         Style="{StaticResource FormTextBoxStyle}"
                         materialDesign:HintAssist.Hint="到达站拼音"
                         Margin="0,8,0,8"/>

                <!-- 第四行：金额、出发站代码 -->
                <TextBlock Grid.Row="3" Grid.Column="0" 
                           Text="金额:" 
                           Style="{StaticResource FormLabelStyle}"/>
                <Grid Grid.Row="3" Grid.Column="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Grid.Column="0" 
                              Text="¥" 
                              VerticalAlignment="Center" 
                              Margin="8,0,4,0"/>
                    <TextBox Grid.Column="1"
                             Text="{Binding Money, StringFormat=F2}"
                             Style="{StaticResource FormTextBoxStyle}"
                             materialDesign:HintAssist.Hint="金额"/>
                    <TextBlock Grid.Column="1" 
                              Text="元" 
                              HorizontalAlignment="Right" 
                              VerticalAlignment="Center" 
                              Margin="0,0,8,0"/>
                </Grid>

                <TextBlock Grid.Row="3" Grid.Column="2" 
                           Text="出发站代码:" 
                           Style="{StaticResource FormLabelStyle}"/>
                <TextBox Grid.Row="3" Grid.Column="3" 
                         Text="{Binding DepartStationCode, UpdateSourceTrigger=PropertyChanged}" 
                         Style="{StaticResource FormTextBoxStyle}"
                         materialDesign:HintAssist.Hint="出发站代码"
                         Margin="0,8,0,8"/>

                <!-- 第五行：到达站代码、出发日期 -->
                <TextBlock Grid.Row="4" Grid.Column="0" 
                           Text="到达站代码:" 
                           Style="{StaticResource FormLabelStyle}"/>
                <TextBox Grid.Row="4" Grid.Column="1" 
                         Text="{Binding ArriveStationCode, UpdateSourceTrigger=PropertyChanged}" 
                         Style="{StaticResource FormTextBoxStyle}"
                         materialDesign:HintAssist.Hint="到达站代码"
                         Margin="0,8,16,8"/>

                <TextBlock Grid.Row="4" Grid.Column="2" 
                           Text="出发日期:" 
                           Style="{StaticResource FormLabelStyle}"/>
                <DatePicker Grid.Row="4" Grid.Column="3" 
                           SelectedDate="{Binding DepartDate}" 
                           Style="{StaticResource MaterialDesignDatePicker}"
                           materialDesign:HintAssist.Hint="出发日期"
                           Margin="0,8,0,8"/>

                <!-- 第六行：车次号、出发时间 -->
                <TextBlock Grid.Row="5" Grid.Column="0" 
                           Text="车次号:" 
                           Style="{StaticResource FormLabelStyle}"/>
                <Grid Grid.Row="5" Grid.Column="1" Margin="0,8,16,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <ComboBox Grid.Column="0" 
                              ItemsSource="{Binding TrainTypes}" 
                              SelectedItem="{Binding SelectedTrainType}" 
                              Width="90" 
                              Style="{StaticResource FormComboBoxStyle}"
                              Margin="0,0,8,0"
                              materialDesign:HintAssist.Hint="车型">
                        <ComboBox.ItemContainerStyle>
                            <Style TargetType="ComboBoxItem" BasedOn="{StaticResource FormComboBoxItemStyle}"/>
                        </ComboBox.ItemContainerStyle>
                    </ComboBox>
                    <TextBox Grid.Column="1" 
                             Text="{Binding TrainNumber, UpdateSourceTrigger=PropertyChanged}"
                             Style="{StaticResource FormTextBoxStyle}"
                             materialDesign:HintAssist.Hint="车次号"
                             Margin="0"/>
                </Grid>

                <TextBlock Grid.Row="5" Grid.Column="2" 
                           Text="出发时间:" 
                           Style="{StaticResource FormLabelStyle}"/>
                <Grid Grid.Row="5" Grid.Column="3" Margin="0,8,0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <ComboBox Grid.Column="0" 
                              ItemsSource="{Binding HourOptions}" 
                              SelectedIndex="{Binding DepartHour}" 
                              Width="60" 
                              Style="{StaticResource FormComboBoxStyle}"
                              Margin="0,0,4,0"
                              materialDesign:HintAssist.Hint="时">
                        <ComboBox.ItemContainerStyle>
                            <Style TargetType="ComboBoxItem" BasedOn="{StaticResource FormComboBoxItemStyle}"/>
                        </ComboBox.ItemContainerStyle>
                    </ComboBox>
                    <ComboBox Grid.Column="1" 
                              ItemsSource="{Binding MinuteOptions}" 
                              SelectedIndex="{Binding DepartMinute}" 
                              Width="60" 
                              Style="{StaticResource FormComboBoxStyle}"
                              Margin="0,0,4,0"
                              materialDesign:HintAssist.Hint="分">
                        <ComboBox.ItemContainerStyle>
                            <Style TargetType="ComboBoxItem" BasedOn="{StaticResource FormComboBoxItemStyle}"/>
                        </ComboBox.ItemContainerStyle>
                    </ComboBox>
                    <TextBlock Grid.Column="2" 
                               Text="开" 
                               VerticalAlignment="Center"/>
                </Grid>

                <!-- 第七行：车厢号 -->
                <TextBlock Grid.Row="6" Grid.Column="0" 
                           Text="车厢号:" 
                           Style="{StaticResource FormLabelStyle}"/>
                <Grid Grid.Row="6" Grid.Column="1" Margin="0,8,16,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBox Grid.Column="0" 
                             Text="{Binding CoachNo, UpdateSourceTrigger=PropertyChanged}"
                             Style="{StaticResource FormNumberTextBoxStyle}"
                             materialDesign:HintAssist.Hint="车厢号"
                             Margin="0"/>
                    <TextBlock Grid.Column="1" 
                               Text="车" 
                               VerticalAlignment="Center" 
                               Margin="4,0,8,0"/>
                    <CheckBox Grid.Column="2" 
                              Content="加车" 
                              IsChecked="{Binding IsExtraCoach}"
                              VerticalAlignment="Center"/>
                </Grid>

                <!-- 第八行：座位号 -->
                <TextBlock Grid.Row="7" Grid.Column="0" 
                           Text="座位号:" 
                           Style="{StaticResource FormLabelStyle}"/>
                <Grid Grid.Row="7" Grid.Column="1" Grid.ColumnSpan="3" Margin="0,8,0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBox Grid.Column="0" 
                             Text="{Binding SeatNo, UpdateSourceTrigger=PropertyChanged}"
                             Style="{StaticResource FormNumberTextBoxStyle}"
                             materialDesign:HintAssist.Hint="座位号"
                             PreviewTextInput="SeatNo_PreviewTextInput"
                             IsEnabled="{Binding IsNoSeat, Converter={StaticResource InverseBooleanConverter}}"
                             Margin="0,0,16,0"/>
                    <ComboBox Grid.Column="1" 
                              ItemsSource="{Binding SeatPositions}" 
                              SelectedItem="{Binding SelectedSeatPosition}" 
                              Width="60" 
                              Style="{StaticResource FormComboBoxStyle}"
                              Visibility="{Binding IsSeatPositionVisible, Converter={StaticResource BooleanToVisibilityConverter}}"
                              IsEnabled="{Binding IsNoSeat, Converter={StaticResource InverseBooleanConverter}}"
                              Margin="0,0,16,0">
                        <ComboBox.ItemContainerStyle>
                            <Style TargetType="ComboBoxItem" BasedOn="{StaticResource FormComboBoxItemStyle}"/>
                        </ComboBox.ItemContainerStyle>
                    </ComboBox>
                    <CheckBox Grid.Column="2" 
                              Content="无座" 
                              IsChecked="{Binding IsNoSeat}" 
                              Margin="16,0,0,0"
                              VerticalAlignment="Center"/>
                </Grid>

                <!-- 座位类型 -->
                <TextBlock Grid.Row="8" Grid.Column="0" 
                           Text="座位类型:" 
                           Style="{StaticResource FormLabelStyle}"/>
                <ComboBox Grid.Row="8" Grid.Column="1" Grid.ColumnSpan="3" 
                          ItemsSource="{Binding SeatTypes}" 
                          SelectedItem="{Binding SelectedSeatType}" 
                          Style="{StaticResource FormComboBoxStyle}"
                          materialDesign:HintAssist.Hint="请选择座位类型"
                          Margin="0,8,0,8">
                    <ComboBox.ItemContainerStyle>
                        <Style TargetType="ComboBoxItem" BasedOn="{StaticResource FormComboBoxItemStyle}"/>
                    </ComboBox.ItemContainerStyle>
                </ComboBox>

                <!-- 附加信息 -->
                <TextBlock Grid.Row="9" Grid.Column="0" 
                           Text="附加信息:" 
                           Style="{StaticResource FormLabelStyle}"/>
                <ComboBox Grid.Row="9" Grid.Column="1" Grid.ColumnSpan="3" 
                          ItemsSource="{Binding AdditionalInfoOptions}" 
                          SelectedItem="{Binding SelectedAdditionalInfo}" 
                          Style="{StaticResource FormComboBoxStyle}"
                          materialDesign:HintAssist.Hint="请选择附加信息"
                          Margin="0,8,0,8">
                    <ComboBox.ItemContainerStyle>
                        <Style TargetType="ComboBoxItem" BasedOn="{StaticResource FormComboBoxItemStyle}"/>
                    </ComboBox.ItemContainerStyle>
                </ComboBox>

                <!-- 车票用途 -->
                <TextBlock Grid.Row="10" Grid.Column="0" 
                           Text="车票用途:" 
                           Style="{StaticResource FormLabelStyle}"/>
                <ComboBox Grid.Row="10" Grid.Column="1" Grid.ColumnSpan="3" 
                          ItemsSource="{Binding TicketPurposeOptions}" 
                          SelectedItem="{Binding SelectedTicketPurpose}" 
                          Style="{StaticResource FormComboBoxStyle}"
                          materialDesign:HintAssist.Hint="请选择车票用途"
                          Margin="0,8,0,8">
                    <ComboBox.ItemContainerStyle>
                        <Style TargetType="ComboBoxItem" BasedOn="{StaticResource FormComboBoxItemStyle}"/>
                    </ComboBox.ItemContainerStyle>
                </ComboBox>

                <!-- 第十二行：车票改签类型 -->
                <TextBlock Grid.Row="11" Grid.Column="0" 
                           Text="车票改签类型:" 
                           Style="{StaticResource FormLabelStyle}"/>
                <ComboBox Grid.Row="11" Grid.Column="1" Grid.ColumnSpan="3"
                         Style="{StaticResource FormComboBoxStyle}"
                         materialDesign:HintAssist.Hint="车票改签类型"
                         SelectedItem="{Binding SelectedTicketModificationType, UpdateSourceTrigger=PropertyChanged}"
                         ItemsSource="{Binding TicketModificationTypes}"
                         IsEditable="False"
                         Margin="0,8,0,8">
                    <ComboBox.ItemContainerStyle>
                        <Style TargetType="ComboBoxItem" BasedOn="{StaticResource FormComboBoxItemStyle}"/>
                    </ComboBox.ItemContainerStyle>
                </ComboBox>

                <!-- 第十三行：提示信息 -->
                <TextBlock Grid.Row="12" Grid.Column="0" 
                           Text="提示信息:" 
                           Style="{StaticResource FormLabelStyle}"/>
                <ComboBox Grid.Row="12" Grid.Column="1" Grid.ColumnSpan="3" 
                          ItemsSource="{Binding HintOptions}" 
                          SelectedItem="{Binding SelectedHint}" 
                          Style="{StaticResource FormComboBoxStyle}"
                          materialDesign:HintAssist.Hint="提示信息"
                          Margin="0,8,0,8">
                    <ComboBox.ItemContainerStyle>
                        <Style TargetType="ComboBoxItem" BasedOn="{StaticResource FormComboBoxItemStyle}"/>
                    </ComboBox.ItemContainerStyle>
                </ComboBox>

                <!-- 第十四行：票种类型 -->
                <TextBlock Grid.Row="13" Grid.Column="0" 
                           Text="票种类型:" 
                           Style="{StaticResource FormLabelStyle}"/>
                <Grid Grid.Row="13" Grid.Column="1" Grid.ColumnSpan="3" Margin="0,8,0,8">
                    <WrapPanel Margin="4,2,0,2">
                        <CheckBox Content="学生票" 
                                  IsChecked="{Binding IsStudentTicket}" 
                                  IsEnabled="{Binding IsStudentTicketEnabled}"
                                  Margin="0,0,24,0"
                                  VerticalAlignment="Center"/>
                        <CheckBox Content="优惠票" 
                                  IsChecked="{Binding IsDiscountTicket}" 
                                  Margin="0,0,24,0"
                                  VerticalAlignment="Center"/>
                        <CheckBox Content="网络售票" 
                                  IsChecked="{Binding IsOnlineTicket}" 
                                  Margin="0,0,24,0"
                                  VerticalAlignment="Center"/>
                        <CheckBox Content="儿童票" 
                                  IsChecked="{Binding IsChildTicket}" 
                                  IsEnabled="{Binding IsChildTicketEnabled}"
                                  Margin="0,0,0,0"
                                  VerticalAlignment="Center"/>
                    </WrapPanel>
                </Grid>

                <!-- 第十五行：支付渠道 -->
                <TextBlock Grid.Row="14" Grid.Column="0" 
                           Text="支付渠道:" 
                           Style="{StaticResource FormLabelStyle}"/>
                <Grid Grid.Row="14" Grid.Column="1" Grid.ColumnSpan="3" Margin="0,8,0,8">
                    <WrapPanel Margin="4,2,0,2">
                        <CheckBox Content="支付宝售票" 
                                  IsChecked="{Binding IsAlipayPayment}" 
                                  IsEnabled="{Binding IsAlipayPaymentEnabled}"
                                  Margin="0,0,24,0"
                                  VerticalAlignment="Center"/>
                        <CheckBox Content="微信售票" 
                                  IsChecked="{Binding IsWeChatPayment}" 
                                  IsEnabled="{Binding IsWeChatPaymentEnabled}"
                                  Margin="0,0,24,0"
                                  VerticalAlignment="Center"/>
                        <CheckBox Content="农业银行" 
                                  IsChecked="{Binding IsABCPayment}" 
                                  Margin="0,0,24,0"
                                  VerticalAlignment="Center"/>
                        <CheckBox Content="建设银行" 
                                  IsChecked="{Binding IsCCBPayment}" 
                                  Margin="0,0,24,0"
                                  VerticalAlignment="Center"/>
                        <CheckBox Content="工商银行" 
                                  IsChecked="{Binding IsICBCPayment}" 
                                  Margin="0,0,0,0"
                                  VerticalAlignment="Center"/>
                    </WrapPanel>
                </Grid>
            </Grid>
        </ScrollViewer>

        <!-- 底部按钮 -->
        <StackPanel Grid.Row="2" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Right" 
                    Margin="0,16,0,0">
            <Button Content="重置" 
                    Command="{Binding ResetCommand}" 
                    Style="{StaticResource MaterialDesignFlatButton}" 
                    materialDesign:ButtonAssist.CornerRadius="4"
                    Foreground="{DynamicResource GlobalAccentBrush}"
                    Margin="0,0,16,0"
                    Height="48"
                    MinHeight="36"
                    FontSize="{DynamicResource MaterialDesignFontSize}"
                    Padding="16,8"/>
            <Button Content="确定" 
                    Command="{Binding SaveCommand}" 
                    Style="{StaticResource MaterialDesignFlatButton}"
                    materialDesign:ButtonAssist.CornerRadius="4"
                    Foreground="{DynamicResource GlobalAccentBrush}"
                    Height="48"
                    MinHeight="36"
                    FontSize="{DynamicResource MaterialDesignFontSize}"
                    Padding="16,8"
                    IsDefault="True"/>
        </StackPanel>
    </Grid>
</Window> 